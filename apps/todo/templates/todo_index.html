<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Todo App</title>

        <link
            rel="stylesheet"
            href="{{ url_for('static', filename='css/tailwind.css') }}"
        />

        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.css"
        />

        <link
            rel="icon"
            href="{{ url_for('static', filename='images/favicon.ico') }}"
            type="image/x-icon"
        />

        <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13"></script>

        <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

        <script
            src="{{ url_for('todo.static', filename='js/main.js') }}"
            defer
        ></script>

        <style>
            html.dark .flatpickr-calendar {
                background: #1f2937; /* gray-800 */
                border-color: #374151; /* gray-700 */
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            }

            html.dark .flatpickr-day,
            html.dark .flatpickr-weekday,
            html.dark .flatpickr-months .flatpickr-month,
            html.dark .flatpickr-current-month .cur-month,
            html.dark .flatpickr-current-month .cur-year,
            html.dark .numInput.cur-year {
                color: #f9fafb; /* gray-50 */
            }

            html.dark .flatpickr-weekday {
                background: #111827; /* gray-900 */
                font-weight: 600;
            }

            html.dark .flatpickr-day:hover,
            html.dark .flatpickr-day:focus {
                background: #374151; /* gray-700 */
                color: #f9fafb;
                border-color: #374151;
            }

            html.dark .flatpickr-day.selected,
            html.dark .flatpickr-day.selected:hover,
            html.dark .flatpickr-day.selected:focus {
                background: #3b82f6; /* blue-500 */
                color: white;
                border-color: #3b82f6;
            }

            html.dark .flatpickr-months .flatpickr-prev-month,
            html.dark .flatpickr-months .flatpickr-next-month {
                color: #f9fafb;
            }
            html.dark .flatpickr-months .flatpickr-prev-month:hover,
            html.dark .flatpickr-months .flatpickr-next-month:hover {
                background: #374151;
                color: #f9fafb;
            }

            /* Time picker (if enabled) */
            html.dark .flatpickr-time input,
            html.dark .flatpickr-time .numInput {
                color: #f9fafb;
                background: transparent;
            }
            html.dark .flatpickr-time input:hover,
            html.dark .flatpickr-time .numInput:hover {
                background: #374151;
            }
            html.dark .flatpickr-time .flatpickr-am-pm:hover {
                background: #374151;
            }
        </style>

        <script>
            (function () {
                const html = document.documentElement;
                const savedTheme = localStorage.getItem("theme");
                if (savedTheme === "dark") {
                    html.classList.add("dark");
                } else {
                    html.classList.remove("dark");
                }
            })();
        </script>
    </head>
    <body
        class="bg-gray-100 dark:bg-gray-900 min-h-screen flex items-center justify-center p-4 transition-colors duration-500"
    >
        <div
            class="bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-6 sm:p-8 w-full max-w-3xl space-y-6"
        >
            <h1
                class="text-3xl sm:text-4xl font-bold text-center text-blue-600 dark:text-blue-400 mb-4"
            >
                âœ… Todo App
            </h1>

            <form id="add-form" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <input
                    type="text"
                    id="note"
                    placeholder="Task note"
                    required
                    autocomplete="off"
                    aria-label="Task note"
                    class="p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                />
                <input
                    type="text"
                    id="duedate"
                    placeholder="Select due date & time"
                    required
                    autocomplete="off"
                    aria-label="Due date and time"
                    class="p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                />
                <select
                    id="priority"
                    required
                    aria-label="Task priority"
                    class="p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                >
                    <option value="">Priority</option>
                    <option>High</option>
                    <option>Medium</option>
                    <option>Low</option>
                </select>
                <select
                    id="category"
                    required
                    aria-label="Task category"
                    class="p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                >
                    <option value="">Category</option>
                    <option>Work</option>
                    <option>Personal</option>
                    <option>Urgent</option>
                </select>

                <div class="sm:col-span-2">
                    <button
                        type="submit"
                        class="w-full py-3 rounded-xl bg-blue-500 hover:bg-blue-600 text-white font-semibold shadow-md transition transform hover:scale-[1.02] active:scale-[0.98]"
                    >
                        Add Task
                    </button>
                </div>
            </form>

            <div
                class="flex flex-col sm:flex-row gap-4 items-center justify-between"
            >
                <input
                    type="text"
                    id="search"
                    placeholder="Search tasks..."
                    aria-label="Search tasks"
                    class="flex-1 p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                />
                <select
                    id="sort"
                    aria-label="Sort tasks"
                    class="p-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"
                >
                    <option value="">Sort By</option>
                    <option value="az">A-Z</option>
                    <option value="za">Z-A</option>
                    <option value="priority">Priority</option>
                    <option value="date">Date</option>
                </select>
            </div>

            <ul id="tasks" class="space-y-4">
                <!-- Tasks will be dynamically rendered here by JS -->
            </ul>
        </div>
    </body>
</html>
